[1m🚀 INICIANDO TESTE COMPLETO DA API FLASK...[0m
[33m📝 Este script testa todas as funcionalidades da API[0m
[33m🔧 Certifique-se de que o servidor Flask está rodando[0m

[1m🚀 TESTE COMPLETO DA API FLASK[0m

[1m🔍 DIAGNÓSTICO INICIAL[0m
[32m✅ Servidor Flask está rodando na porta 5000[0m

[1m📋 SEÇÃO 1: AUTENTICAÇÃO E JWT[0m

[36m=== Login RH ===[0m
✅ Status: [32m200[0m
[33mResponse: { access_token: '***', usuario: {...} }[0m

[36m=== Login Gestor ===[0m
✅ Status: [32m200[0m
[33mResponse: { access_token: '***', usuario: {...} }[0m

[36m=== Login Usuário Comum ===[0m
✅ Status: [32m200[0m
[33mResponse: { access_token: '***', usuario: {...} }[0m

[36m=== Login Inválido (deve falhar) ===[0m
✅ Status: [32m401[0m
[33mResponse: {
  "autenticado": false,
  "erro": "Credenciais inválidas"
}[0m

[36m=== Endpoint /me ===[0m
✅ Status: [32m200[0m
[33mResponse: {
  "usuario": {
    "ativo": true,
    "criado_em": "2025-05-28T05:38:36.073185",
    "email": "maria.rh@techsolutions.com",
    "ferias_tiradas": 0,
    "grupo_id": 1,
    "grupo_nome": "Recursos Hu...[0m

[36m=== Refresh Token ===[0m
✅ Status: [32m200[0m
[33mResponse: { access_token: '***', usuario: {...} }[0m

[1m📋 SEÇÃO 2: GESTÃO DE EMPRESAS[0m

[36m=== Listar Empresas (RH) ===[0m
✅ Status: [32m200[0m
[33mResponse: Array com 1 itens[0m

[36m=== Obter Empresa 1 ===[0m
✅ Status: [32m200[0m
[33mResponse: {
  "ativa": true,
  "cnpj": "12.345.678/0001-90",
  "criado_em": "2025-05-28T05:38:35.899753",
  "email": "empresa@techsolutions.com",
  "endereco": "Rua das Flores, 123 - São Paulo/SP",
  "id": 1,
 ...[0m

[36m=== Criar Empresa ===[0m
✅ Status: [32m201[0m
[33mResponse: {
  "ativa": true,
  "cnpj": "36309586/0001-96",
  "criado_em": "2025-06-04T17:44:43.276316",
  "email": "teste1749059083270@empresa.com",
  "endereco": "Rua Teste, 123",
  "id": 2,
  "nome": "Empresa...[0m

[36m=== Gestor tentando listar empresas (deve falhar) ===[0m
✅ Status: [32m403[0m
[33mResponse: {
  "erro": "Sem permissão para listar empresas"
}[0m

[1m📋 SEÇÃO 3: GESTÃO DE GRUPOS[0m

[36m=== Listar Grupos (RH) ===[0m
✅ Status: [32m200[0m
[33mResponse: Array com 3 itens[0m

[36m=== Obter Grupo 1 ===[0m
✅ Status: [32m200[0m
[33mResponse: {
  "ativo": true,
  "criado_em": "2025-05-28T05:38:35.916568",
  "descricao": "Equipe de recursos humanos",
  "empresa_id": 1,
  "empresa_nome": "Tech Solutions LTDA",
  "id": 1,
  "nome": "Recursos ...[0m

[36m=== Estatísticas Grupo 1 ===[0m
✅ Status: [32m200[0m
[33mResponse: {
  "eventos_aprovados": 0,
  "eventos_pendentes": 1,
  "grupo": "Recursos Humanos",
  "total_usuarios": 2,
  "usuarios_ativos": 2
}[0m

[36m=== Criar Grupo ===[0m
✅ Status: [32m201[0m
[33mResponse: {
  "ativo": true,
  "criado_em": "2025-06-04T17:44:43.349407",
  "descricao": "Grupo criado durante teste",
  "empresa_id": 1,
  "empresa_nome": "Tech Solutions LTDA",
  "id": 4,
  "nome": "Grupo Tes...[0m

[1m📋 SEÇÃO 4: GESTÃO DE USUÁRIOS[0m

[36m=== Listar Usuários (RH) ===[0m
✅ Status: [32m200[0m
[33mResponse: Array com 6 itens[0m

[36m=== Usuários do Grupo 2 ===[0m
✅ Status: [32m200[0m
[33mResponse: Array com 3 itens[0m

[36m=== Obter Usuário 1 ===[0m
✅ Status: [32m200[0m
[33mResponse: {
  "ativo": true,
  "criado_em": "2025-05-28T05:38:36.073185",
  "email": "maria.rh@techsolutions.com",
  "ferias_tiradas": 0,
  "grupo_id": 1,
  "grupo_nome": "Recursos Humanos",
  "id": 1,
  "inici...[0m

[36m=== Criar Usuário ===[0m
✅ Status: [32m201[0m
[33mResponse: {
  "ativo": true,
  "criado_em": "2025-06-04T17:44:43.539889",
  "email": "teste1749059083414@techsolutions.com",
  "ferias_tiradas": 0,
  "grupo_id": 2,
  "grupo_nome": "Desenvolvimento",
  "id": 7,...[0m

[36m=== Gestor listando usuários ===[0m
✅ Status: [32m200[0m
[33mResponse: Array com 4 itens[0m

[1m📋 SEÇÃO 5: GESTÃO DE EVENTOS[0m

[36m=== Listar Eventos (Usuário) ===[0m
✅ Status: [32m200[0m
[33mResponse: Array com 5 itens[0m

[36m=== Criar Evento ===[0m
✅ Status: [32m201[0m
[33mResponse: {
  "aprovado_por_id": null,
  "aprovado_por_nome": null,
  "criado_em": "2025-06-04T17:44:43.594527",
  "data_aprovacao": null,
  "data_fim": "2024-12-19",
  "data_inicio": "2024-12-15",
  "descricao...[0m

[36m=== Obter Evento Criado ===[0m
✅ Status: [32m200[0m
[33mResponse: {
  "aprovado_por_id": null,
  "aprovado_por_nome": null,
  "criado_em": "2025-06-04T17:44:43.594527",
  "data_aprovacao": null,
  "data_fim": "2024-12-19",
  "data_inicio": "2024-12-15",
  "descricao...[0m

[36m=== Aprovar Evento (Gestor) ===[0m
✅ Status: [32m200[0m
[33mResponse: {
  "status": "Evento aprovado"
}[0m

[1m📋 SEÇÃO 6: CALENDÁRIO[0m

[36m=== Calendário Geral ===[0m
✅ Status: [32m200[0m
[33mResponse: Array com 1 itens[0m

[36m=== Calendário Grupo 2 ===[0m
✅ Status: [32m200[0m
[33mResponse: {
  "eventos": [
    {
      "color": "red",
      "end": "2024-02-20",
      "extendedProps": {
        "description": "Férias de carnaval",
        "shift": null,
        "status": "aprovado",
     ...[0m

[1m📋 SEÇÃO 7: VALIDAÇÕES DE SEGURANÇA[0m

[36m=== Acesso sem token (deve falhar) ===[0m
✅ Status: [32m401[0m
[33mResponse: {
  "erro": "Token de autenticação necessário"
}[0m

[36m=== Token inválido (deve falhar) ===[0m
✅ Status: [32m401[0m
[33mResponse: {
  "erro": "Token inválido"
}[0m

[36m=== Usuário comum criando usuário (deve falhar) ===[0m
✅ Status: [32m403[0m
[33mResponse: {
  "erro": "Sem permissão para criar usuários"
}[0m

[36m=== Criar usuário com dados inválidos (deve falhar) ===[0m
✅ Status: [32m400[0m
[33mResponse: {
  "erro": "Parâmetro ausente: 'email'"
}[0m

[36m=== Logout ===[0m
✅ Status: [32m200[0m
[33mResponse: {
  "message": "Logout realizado com sucesso"
}[0m

[1m📊 RELATÓRIO FINAL[0m
============================================================
[1mTotal de Testes:[0m 30
[32mTestes Passaram:[0m 30
[31mTestes Falharam:[0m 0
[1mTaxa de Sucesso:[0m [32m100.0%[0m

[1m🔍 ANÁLISE POR SEÇÃO:[0m
[36m1. Autenticação:[0m Sistema JWT funcionando
[36m2. Empresas:[0m CRUD com permissões RH
[36m3. Grupos:[0m Gestão hierárquica
[36m4. Usuários:[0m Controle de acesso por nível
[36m5. Eventos:[0m Sistema de aprovação
[36m6. Calendário:[0m Visualização de eventos
[36m7. Segurança:[0m Validações e permissões

[32m🎉 API FUNCIONANDO PERFEITAMENTE![0m
[32m✅ Todos os sistemas principais estão operacionais[0m

[1m💡 PRÓXIMOS PASSOS:[0m
[32m- API pronta para uso em produção[0m
[32m- Considerar implementar testes automatizados[0m
[32m- Documentar endpoints para equipe[0m
